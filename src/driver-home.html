<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="shared-styles.html">

<dom-module id="driver-home">

  <template>
    <style include="shared-styles">
      :host {
        display: block;

        padding: 10px;
      }
      
    </style>
<paper-button raised class="custom green" 
            on-click="_syncData">Sync </paper-button>
  <template is="dom-repeat" items="[[countriesDropPicup]]">
      <div class="card item">
  <h1>[[item.CountryName]]</h1>

       <a href="/drop/{{item.CountryName}}" tabindex="-1"><paper-button raised class="custom blue"  >Drop : [[item.Drop]]</paper-button></a>
 <a href="/pickup/{{item.CountryName}}" tabindex="-1"><paper-button raised class="custom red" > Pickup : [[item.Pickup]]</paper-button></a>
      </div>
    </template>

  </template>

  <script>
    Polymer({
      is: 'driver-home',
       properties: {

    documents:  Array,
    countriesDropPicup: {
          type: Array,
          computed: '_countries(documents.splices)',
          notify: true
        },
       

      },

_countries: function(){
  
 var documentsCategory = [];
var categoryList = [];
  for (var i = 0; i < this.documents.length; i++) {
    if(categoryList.indexOf(this.documents[i].CountryName) ==-1){
   categoryList.push(this.documents[i].CountryName);
    }
  }
  for (var i = 0; i < categoryList.length; i++) {
   var cat = categoryList[i];
   var country = {'CountryName' :cat  , 'Drop' :0 , 'Pickup':0 };
   for (var j = 0; j < this.documents.length; j++) {
    
    if(cat ==this.documents[j].CountryName){
       if(this.documents[j].Drop==0)country.Drop++ ;
       else country.Pickup++ ; 
    }
  }
documentsCategory.push(country);
  }
return documentsCategory;
}  ,
_syncData : function (){

    this.fire('sync-data');
    
}
    });
  </script>
</dom-module>
